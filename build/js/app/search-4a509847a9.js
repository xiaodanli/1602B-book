require(["jquery","header","render","text!bookSearchTpl","storage"],function(e,t,s,a,o){console.log(t),t({isSearch:!0}),e("body").append(a);var n=o.get("history")||[],c=[];function r(t){for(var a={},e=[],s=0;s<t.length;s++)a[t[s]]||(e.push(t[s]),a[t[s]]=1);return e}function i(t){e.ajax({url:"/api/search",dataType:"json",data:{key:t},success:function(t){console.log(t),e(".search-list").html(" "),t?s(t.items,e("#search-template"),e(".search-list")):e(".search-list").html("<p>暂无搜索数据</p>")},error:function(t){console.warn(t)}})}e.ajax({url:"/api/hot",dataType:"json",success:function(t){console.log(t),t.ads.forEach(function(t,a){c.push(t.ad_name)});var a=c.concat(n);s(r(a),e("#tag-tpl"),e(".type-tags"),!0)},error:function(t){console.warn(t)}}),e(".search-btn").on("click",function(){var t=e(".ipt").val();e(".type-tags").hide(),e(".search-list").show(),t?(console.log("ajax"),n.push(t),o.set("history",n),i(t)):e(".search-list").html("<p>搜索内容为空</p>")}),e(".ipt").on("input",function(){if(!e(this).val()){var t=o.get("history")||[],a=c.concat(t);s(r(a),e("#tag-tpl"),e(".type-tags"),!0),e(".type-tags").show(),e(".search-list").html(" "),e(".search-list").hide()}}),e(".type-tags").on("click","li",function(){var t=e(this).text();e(".ipt").val(t),i(t),e(".type-tags").hide(),e(".search-list").show()})});